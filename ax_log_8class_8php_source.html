<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Axiom: H:/Workspace/php-axiom/www/php-axiom/libraries/axiom/axLog.class.php Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="new_stylesheet.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
	<h1>Axiom (v1.2.0)</h1>
	<span>A lightweight PHP framework</span>
	        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>

</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="dynsections.js"></script>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('ax_log_8class_8php.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">H:/Workspace/php-axiom/www/php-axiom/libraries/axiom/axLog.class.php</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ax_log_8class_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00021"></a><a class="code" href="classax_log.html">00021</a> <span class="keyword">class </span><a class="code" href="classax_log.html">axLog</a> {
<a name="l00022"></a>00022     
<a name="l00027"></a><a class="code" href="classax_log.html#ace3b34be9cfe6d5f7d7a4b2675ef033e">00027</a>     <span class="keyword">protected</span> <a class="code" href="classax_log.html#ace3b34be9cfe6d5f7d7a4b2675ef033e">$_options</a>;
<a name="l00028"></a>00028     
<a name="l00033"></a><a class="code" href="classax_log.html#a8a5e87eeb5481552f40e44b2ffddfa28">00033</a>     <span class="keyword">protected</span> <a class="code" href="classax_log.html#a8a5e87eeb5481552f40e44b2ffddfa28">$_first</a>;
<a name="l00034"></a>00034     
<a name="l00039"></a><a class="code" href="classax_log.html#ac5ed761f28731253cd00ff651dc935cd">00039</a>     <span class="keyword">protected</span> <a class="code" href="classax_log.html#ac5ed761f28731253cd00ff651dc935cd">$_last</a>;
<a name="l00040"></a>00040     
<a name="l00045"></a><a class="code" href="classax_log.html#a8de84a22af3650155d129f3c041bf3cb">00045</a>     <span class="keyword">protected</span> <a class="code" href="classax_log.html#a8de84a22af3650155d129f3c041bf3cb">$_message_history</a> = array();
<a name="l00046"></a>00046     
<a name="l00047"></a><a class="code" href="classax_log.html#ad9f97dc3b395671f3c5e660f35d7effb">00047</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#ad9f97dc3b395671f3c5e660f35d7effb">__construct</a> (array $options = array()) {
<a name="l00048"></a>00048                 $default = array(
<a name="l00049"></a>00049                                 <span class="stringliteral">&#39;ignore_repeated_messages&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l00050"></a>00050                                 <span class="stringliteral">&#39;log_errors&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l00051"></a>00051                                 <span class="stringliteral">&#39;log_exception&#39;</span> =&gt; <span class="keyword">true</span>,
<a name="l00052"></a>00052                 );
<a name="l00053"></a>00053                 
<a name="l00054"></a>00054                 $this-&gt;_options = $options;
<a name="l00055"></a>00055                 
<a name="l00056"></a>00056                 <span class="keywordflow">if</span> ($this-&gt;_options[<span class="stringliteral">&#39;log_errors&#39;</span>])
<a name="l00057"></a>00057             $this-&gt;<a class="code" href="classax_log.html#af5a1bb036a561abc5344cf357de534eb">registerErrorHandler</a>();
<a name="l00058"></a>00058             
<a name="l00059"></a>00059         <span class="keywordflow">if</span> ($this-&gt;_options[<span class="stringliteral">&#39;log_exception&#39;</span>])
<a name="l00060"></a>00060             $this-&gt;<a class="code" href="classax_log.html#a72cc5d4c1d4603fd3f4c1c665add56ab">registerExceptionHandler</a>();
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062     
<a name="l00069"></a><a class="code" href="classax_log.html#a280aa98c87ad5a0c377e4dcab0cee42b">00069</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a280aa98c87ad5a0c377e4dcab0cee42b">message</a> ($msg, $priority) {
<a name="l00070"></a>00070         <span class="keywordflow">if</span> (!isset($this-&gt;_first))
<a name="l00071"></a>00071             <span class="keywordflow">return</span>;
<a name="l00072"></a>00072         
<a name="l00073"></a>00073         <span class="keywordflow">if</span> ($this-&gt;_options[<span class="stringliteral">&#39;ignore_repeated_messages&#39;</span>] &amp;&amp; array_search($msg, $this-&gt;_message_history) !== <span class="keyword">false</span>)
<a name="l00074"></a>00074                                                 <span class="keywordflow">return</span>;
<a name="l00075"></a>00075         
<a name="l00076"></a>00076         $this-&gt;_first-&gt;message($this-&gt;_message_history[] = $msg, $priority);
<a name="l00077"></a>00077     }
<a name="l00078"></a>00078     
<a name="l00084"></a><a class="code" href="classax_log.html#a98682ff7b4c8f438ba8b49d6cd1ca869">00084</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a98682ff7b4c8f438ba8b49d6cd1ca869">error</a> ($msg) {
<a name="l00085"></a>00085         $this-&gt;<a class="code" href="classax_log.html#a280aa98c87ad5a0c377e4dcab0cee42b">message</a>($msg, <a class="code" href="classax_logger.html#ade487db4a22a973431571c8efc5cb0e8">axLogger::ERR</a>);
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087     
<a name="l00093"></a><a class="code" href="classax_log.html#ad250e8ba5871e624960fa9f2f5674859">00093</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#ad250e8ba5871e624960fa9f2f5674859">notice</a> ($msg) {
<a name="l00094"></a>00094         $this-&gt;<a class="code" href="classax_log.html#a280aa98c87ad5a0c377e4dcab0cee42b">message</a>($msg, <a class="code" href="classax_logger.html#ac8332324f2ccd1009199c326c09476db">axLogger::NOTICE</a>);
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096     
<a name="l00102"></a><a class="code" href="classax_log.html#a8fa7794f55cad31aa00dbdd9128c5136">00102</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a8fa7794f55cad31aa00dbdd9128c5136">warning</a> ($msg) {
<a name="l00103"></a>00103         $this-&gt;<a class="code" href="classax_log.html#a280aa98c87ad5a0c377e4dcab0cee42b">message</a>($msg, <a class="code" href="classax_logger.html#a5c7ac7fe80395ab2b6d781d3e0a5d0f3">axLogger::WARNING</a>);
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105     
<a name="l00116"></a><a class="code" href="classax_log.html#a3017064c9ad9f9b2730d2c749517b8ef">00116</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a3017064c9ad9f9b2730d2c749517b8ef">debug</a> ($msg, array $bt = array()) {
<a name="l00117"></a>00117         <span class="keywordflow">if</span> ($bt)
<a name="l00118"></a>00118             $msg .= <span class="stringliteral">&quot; in {$bt[0][&#39;file&#39;]} on line {$bt[0][&#39;line&#39;]}&quot;</span>;
<a name="l00119"></a>00119         
<a name="l00120"></a>00120         $this-&gt;<a class="code" href="classax_log.html#a280aa98c87ad5a0c377e4dcab0cee42b">message</a>($msg, <a class="code" href="classax_logger.html#a28c35250a436286d25e80743d50d57fc">axLogger::DEBUG</a>);
<a name="l00121"></a>00121     }
<a name="l00122"></a>00122     
<a name="l00128"></a><a class="code" href="classax_log.html#abe881423946fb2e76eb3d863e6ca4a14">00128</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#abe881423946fb2e76eb3d863e6ca4a14">addLogger</a> (<a class="code" href="classax_logger.html">axLogger</a> $logger) {
<a name="l00129"></a>00129         <span class="keywordflow">if</span> (!isset($this-&gt;_first))
<a name="l00130"></a>00130             $this-&gt;_first = $this-&gt;_last = $logger;
<a name="l00131"></a>00131         <span class="keywordflow">else</span>
<a name="l00132"></a>00132             $this-&gt;_last-&gt;<a class="code" href="classax_logger.html#a43b8dd73b9f7e55a3628d338fddad423">setNext</a>($this-&gt;_last = $logger);
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134     
<a name="l00140"></a><a class="code" href="classax_log.html#af5a1bb036a561abc5344cf357de534eb">00140</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#af5a1bb036a561abc5344cf357de534eb">registerErrorHandler</a> ($error_types = -1) {
<a name="l00141"></a>00141         <span class="keywordflow">return</span> set_error_handler(array($this, <span class="stringliteral">&#39;handleError&#39;</span>));
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143     
<a name="l00148"></a><a class="code" href="classax_log.html#a825d89ed7abc1530a865741247658ecc">00148</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a825d89ed7abc1530a865741247658ecc">restoreErrorHandler</a> () {
<a name="l00149"></a>00149         <span class="keywordflow">return</span> restore_error_handler();
<a name="l00150"></a>00150     }
<a name="l00151"></a>00151     
<a name="l00161"></a><a class="code" href="classax_log.html#afcf2a5d9e25f1a2e4772a108bdd1c429">00161</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#afcf2a5d9e25f1a2e4772a108bdd1c429">handleError</a> ($errno, $errstr, $errfile, $errline) {
<a name="l00162"></a>00162         $error = <span class="stringliteral">&quot;(PHP Error) $errstr in $errfile on line $errline&quot;</span>;
<a name="l00163"></a>00163         <span class="keywordflow">switch</span> ($errno) {
<a name="l00164"></a>00164             <span class="keywordflow">case</span> E_STRICT:
<a name="l00165"></a>00165             <span class="keywordflow">case</span> E_WARNING:
<a name="l00166"></a>00166             <span class="keywordflow">case</span> E_USER_WARNING:
<a name="l00167"></a>00167                 $this-&gt;<a class="code" href="classax_log.html#a8fa7794f55cad31aa00dbdd9128c5136">warning</a>($error);
<a name="l00168"></a>00168                 <span class="keywordflow">break</span>;
<a name="l00169"></a>00169                 
<a name="l00170"></a>00170             <span class="keywordflow">case</span> E_NOTICE:
<a name="l00171"></a>00171             <span class="keywordflow">case</span> E_USER_NOTICE:
<a name="l00172"></a>00172                 $this-&gt;<a class="code" href="classax_log.html#ad250e8ba5871e624960fa9f2f5674859">notice</a>($error);
<a name="l00173"></a>00173                 <span class="keywordflow">break</span>;
<a name="l00174"></a>00174             
<a name="l00175"></a>00175             <span class="keywordflow">case</span> E_USER_ERROR:
<a name="l00176"></a>00176                 $this-&gt;<a class="code" href="classax_log.html#a98682ff7b4c8f438ba8b49d6cd1ca869">error</a>($error);
<a name="l00177"></a>00177                 <span class="keywordflow">break</span>;
<a name="l00178"></a>00178                 
<a name="l00179"></a>00179             <span class="keywordflow">default</span>:
<a name="l00180"></a>00180             <span class="keywordflow">case</span> E_RECOVERABLE_ERROR:
<a name="l00181"></a>00181                 <span class="keywordflow">throw</span> <span class="keyword">new</span> ErrorException($errstr, 2048, $errno, $errfile, $errline);
<a name="l00182"></a>00182                 <span class="keywordflow">break</span>;
<a name="l00183"></a>00183         }
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185     
<a name="l00190"></a><a class="code" href="classax_log.html#a72cc5d4c1d4603fd3f4c1c665add56ab">00190</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a72cc5d4c1d4603fd3f4c1c665add56ab">registerExceptionHandler</a> () {
<a name="l00191"></a>00191         <span class="keywordflow">return</span> set_exception_handler(array($this, <span class="stringliteral">&#39;handleException&#39;</span>));
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193     
<a name="l00198"></a><a class="code" href="classax_log.html#a767d14412a9ab37fcd3c50fdfe4699c7">00198</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a767d14412a9ab37fcd3c50fdfe4699c7">restoreExceptionHandler</a> () {
<a name="l00199"></a>00199         <span class="keywordflow">return</span> restore_exception_handler();
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201     
<a name="l00215"></a><a class="code" href="classax_log.html#aa1bbe27cedd9bc0d2539405670e0abed">00215</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#aa1bbe27cedd9bc0d2539405670e0abed">handleException</a> (Exception $exception) {
<a name="l00216"></a>00216         <span class="keywordflow">if</span> (PHP_VERSION_ID &gt;= 50300) {
<a name="l00217"></a>00217             <span class="keywordflow">if</span> ($previous = $exception-&gt;getPrevious()) {
<a name="l00218"></a>00218                 $this-&gt;<a class="code" href="classax_log.html#aa1bbe27cedd9bc0d2539405670e0abed">handleException</a>($previous);
<a name="l00219"></a>00219             }
<a name="l00220"></a>00220         }
<a name="l00221"></a>00221         
<a name="l00222"></a>00222         $error = <span class="stringliteral">&quot;(PHP Exception) &quot;</span> . $exception-&gt;getMessage() . <span class="stringliteral">&#39; in &#39;</span> . $exception-&gt;getFile() . <span class="stringliteral">&#39; on line &#39;</span> . $exception-&gt;getLine();
<a name="l00223"></a>00223         $this-&gt;<a class="code" href="classax_log.html#a98682ff7b4c8f438ba8b49d6cd1ca869">error</a>($error);
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225     
<a name="l00230"></a><a class="code" href="classax_log.html#a1aa00fb371d13a18533086bd267b36ef">00230</a>     <span class="keyword">public</span> <span class="keyword">function</span> <a class="code" href="classax_log.html#a1aa00fb371d13a18533086bd267b36ef">getHistory</a> () {
<a name="l00231"></a>00231         <span class="keywordflow">return</span> $this-&gt;_message_history;
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233 }
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="ax_log_8class_8php.html">axLog.class.php</a>      </li>

    <li class="footer">Generated on Tue Feb 21 2012 18:14:02 for Axiom by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
